#ifndef ANIMATION_H
#define ANIMATION_H

#include "frame.h"
#include "modelstructure.h"

class Animation
{

    float roomEpsilon;
    float frameRate;
    ModelStructure* baseStructure;

    std::string name;
    std::vector<Frame> frames;

    std::vector<ModelStructure> structuresInFrames; //output
public:
    Animation(float Epsilon, std::string name = "Animation_def" , ModelStructure *struc = NULL);

    void AddFrame(Frame k);
    void AddFrame(std::vector<vec3> pts, std::vector<std::vector<Line> > lines, int elapsed);
    void Save(ExportFormat format, std::string file);
    void PostProcess();

    //getters
    std::string getName() const {return name;}
    float getFrameRate() const {return frameRate;}
    int getLength() const {return  frames.size();}

    //setters
    void setName(std::string name) {name = name;}

private:
    void SaveBVH(std::ofstream &outputFile);

    //postprocessing
    void handleBadFrames(std::vector<size_t> frames);
    void findStructure();
};

#endif // ANIMATION_H
